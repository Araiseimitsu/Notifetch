# NotiFetch - Notion データ取得・分析ツール

![NotiFetch Logo](assets/logo.png)

NotiFetch は、Notion のデータを技術知識なしで誰でも簡単に取得し、AI（Gemini）を使って分析できるデスクトップアプリケーションです。

## 🚀 特徴

- **簡単操作**: 技術知識不要で Notion データを取得
- **多様なデータ形式**: ページとデータベース両方に対応
- **柔軟なデータ取得**: 取得行数を指定可能（100 行〜5000 行、またはカスタム指定）
- **多様な出力形式**: CSV、Excel、HTML、テキスト、Markdown での保存に対応
- **AI 分析**: Gemini AI を使った自然言語でのデータ分析（簡素化されたプロンプト対応）
- **分析結果エクスポート**: AI 分析結果をテキスト・Markdown 形式でダウンロード可能
- **HTML インフォグラフィック**: データを美しい HTML レポートとして可視化
- **自動洞察生成**: データから自動的にビジネス洞察を抽出
- **セキュア**: API トークンの暗号化保存
- **日本語対応**: 完全日本語インターフェース

## 📋 システム要件

- Windows 10/11
- Python 3.9 以上
- インターネット接続（API 通信用）

## 🛠️ インストール

### 1. リポジトリのクローン

```bash
git clone https://github.com/your-username/notifetch.git
cd notifetch
```

### 2. 仮想環境の作成

```bash
python -m venv venv
venv\Scripts\activate  # Windows
```

### 3. 依存関係のインストール

```bash
pip install -r requirements.txt
```

## 🔧 セットアップ

### 1. Notion API トークンの取得

1. [Notion Developers](https://developers.notion.com/)にアクセス
2. 新しいインテグレーションを作成
3. API トークンをコピー
4. 対象の Notion ページ/データベースにインテグレーションを招待

### 2. Gemini API キーの取得（オプション）

1. [Google AI Studio](https://makersuite.google.com/app/apikey)にアクセス
2. API キーを生成
3. アプリケーションに設定

## 🚀 使用方法

### 1. アプリケーションの起動

```bash
python main.py
```

### 2. 基本的な使用手順

1. **接続設定タブ**で Notion API トークンを入力
2. **接続テスト**で API の動作を確認
3. **ページ/データベース ID**を入力して検証
4. **データ取得タブ**で取得行数を設定してデータを取得
5. **CSV/Excel/HTML**などお好みの形式でデータをエクスポート
6. **AI 分析タブ**で Gemini API キーを設定（オプション）
7. 自然言語でデータ分析を実行し、結果をダウンロード
8. **インフォグラフィック**機能で美しい HTML レポートを生成

### 3. 新機能の詳細

#### 📊 データ取得行数指定

- **すべて**: データベース内の全てのデータを取得
- **100 行/500 行/1000 行/2000 行/5000 行**: 事前定義された行数で取得
- **カスタム**: 任意の行数を指定して取得

#### 📄 分析結果ダウンロード

- AI 分析完了後、「📝 分析結果ダウンロード」ボタンが有効化
- **テキスト形式** (.txt): プレーンテキストでの保存
- **Markdown 形式** (.md): 構造化された Markdown 形式での保存
- ヘッダー情報（生成日時、データ行数・列数）を自動追加

#### 🎨 HTML インフォグラフィック

- データを美しい HTML レポートとして視覚化
- レスポンシブデザイン（モバイル・デスクトップ対応）
- モダンな CSS（グラデーション、シャドウ、カードレイアウト）
- 印刷対応スタイル

#### 🤖 改良された AI 分析

- **簡素化されたプロンプト**: ユーザーの質問をそのまま処理
- **カスタム指示対応**: 形式指定なしで自然な対話が可能
- **自動洞察生成**: データから自動的にビジネス洞察を抽出

## 📊 対応データ形式

### Notion ページ

- 見出し（H1, H2, H3）
- 段落
- リスト（箇条書き、番号付き）
- To-do リスト
- コードブロック
- 引用
- コールアウト

### Notion データベース

- タイトル
- リッチテキスト
- 数値
- 選択（単一・複数）
- 日付
- チェックボックス
- URL
- メール
- 電話番号
- ユーザー
- リレーション
- 数式
- ロールアップ

## 📤 エクスポート形式

### データエクスポート

- **CSV**: 表計算ソフトで編集可能
- **Excel**: Excel ファイル形式(.xlsx)
- **HTML**: Web ブラウザで表示可能なテーブル形式

### 分析結果エクスポート

- **テキスト**: プレーンテキスト形式(.txt)
- **Markdown**: GitHub 等で表示可能な構造化形式(.md)
- **HTML**: 美しいインフォグラフィック形式

## 🤖 AI 分析機能

### 自然言語クエリ例

- "このデータの傾向を教えて"
- "売上が最も高い月はいつですか？"
- "異常値や注目すべき点はありますか？"
- "データの品質に問題はありますか？"
- "生産技術課のメンバーの詳細な分析をしてください"

### 自動洞察生成

- データの全体的な傾向分析
- 異常値の検出
- データ品質の評価
- ビジネス上の示唆の提供
- 潜在的な改善点の特定

### インフォグラフィック機能

- 主要統計の視覚化
- カード形式での重要数値表示
- データ洞察の視覚的表現
- チャート・グラフの自動生成
- プロフェッショナルなレポート作成

## 📁 プロジェクト構造

```
notifetch/
├── main.py                 # アプリケーションエントリーポイント
├── requirements.txt        # 依存関係
├── README.md              # このファイル
├── todo.md                # 開発タスク管理
├── outline.md             # プロジェクト概要
├── src/
│   ├── config/            # 設定管理
│   │   ├── __init__.py
│   │   └── settings.py
│   ├── core/              # コアロジック
│   │   ├── __init__.py
│   │   ├── notion_client.py    # Notion API クライアント
│   │   └── gemini_client.py    # Gemini AI クライアント（改良版）
│   ├── ui/                # ユーザーインターフェース
│   │   ├── __init__.py
│   │   └── main_window.py      # メインウィンドウ（新機能対応）
│   └── utils/             # ユーティリティ
│       ├── __init__.py
│       └── data_converter.py
├── tests/                 # テストファイル
├── assets/                # アセット（アイコン等）
└── venv/                  # 仮想環境
```

## 🔒 セキュリティ

- API トークンは暗号化してローカルに保存
- 設定ファイルはユーザーディレクトリに安全に保存
- ネットワーク通信は HTTPS 経由のみ

## 📝 ログ

アプリケーションのログは以下の場所に保存されます：

- Windows: `%USERPROFILE%\.notifetch\logs\notifetch.log`

## 🐛 トラブルシューティング

### よくある問題

1. **Notion API 接続エラー**

   - API トークンが正しいか確認
   - インテグレーションがページに招待されているか確認

2. **ページが見つからない**

   - ページ ID が正しいか確認
   - ページへのアクセス権限があるか確認

3. **Gemini API 接続エラー**

   - API キーが正しいか確認
   - API の利用制限に達していないか確認

4. **データ取得制限エラー**

   - 指定した行数がデータベースの総行数を超えていないか確認
   - カスタム行数は 1 以上の数値を入力

5. **インフォグラフィック生成エラー**
   - データに NULL 値が多すぎる場合はデータクリーニングを実行
   - データ量が少なすぎる場合は追加データの取得を検討

## 🆕 最新機能（v2.0）

### 🎯 データ取得の改善

- **行数指定機能**: 効率的なデータ取得のための柔軟な制限設定
- **パフォーマンス向上**: 大容量データベースでの取得速度改善

### 🤖 AI 分析の強化

- **プロンプト簡素化**: ユーザーの自然な質問をそのまま処理
- **カスタム指示対応**: 詳細な分析要求への柔軟な対応
- **結果ダウンロード**: 分析結果の永続的な保存が可能

### 📊 可視化機能の追加

- **HTML インフォグラフィック**: プロフェッショナルなレポート作成
- **レスポンシブデザイン**: あらゆるデバイスで最適表示
- **印刷対応**: 高品質な印刷出力をサポート

## 🤝 コントリビューション

1. このリポジトリをフォーク
2. 機能ブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを作成

## 📄 ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。詳細は[LICENSE](LICENSE)ファイルを参照してください。

## 🙏 謝辞

- [Notion API](https://developers.notion.com/) - データ取得機能
- [Google Gemini](https://ai.google.dev/) - AI 分析機能
- [PySide6](https://doc.qt.io/qtforpython/) - GUI フレームワーク
- [pandas](https://pandas.pydata.org/) - データ処理

## 📞 サポート

問題や質問がある場合は、[Issues](https://github.com/your-username/notifetch/issues)で報告してください。

---

**NotiFetch v2.0** - Notion データを簡単に取得・分析・可視化 🚀
